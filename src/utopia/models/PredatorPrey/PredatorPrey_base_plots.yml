# Base plot configuration pool for this model
#
# The configurations given here can be used in the <model_name>_plots.yml file.
---
.variables:
  base_path: &base_path data/PredatorPrey



# =============================================================================
#  ╔╦╗╔═╗╔╦╗╔═╗╦  ╔═╗╔╦╗╔═╗╔═╗
#   ║ ║╣ ║║║╠═╝║  ╠═╣ ║ ║╣ ╚═╗
#   ╩ ╚═╝╩ ╩╩  ╩═╝╩ ╩ ╩ ╚═╝╚═╝
# =============================================================================
# -- Overloads ----------------------------------------------------------------
# Overload some configs to insert model-specific settings

# Model-specific defaults
.defaults:
  based_on: .defaults

  # Can define something here ...


# .. Creators .................................................................
.creator.universe:
  based_on:
    - .creator.universe
    - .defaults

  dag_options:
    select_path_prefix: *base_path

.creator.multiverse:
  based_on:
    - .creator.multiverse
    - .defaults

  select_and_combine:
    base_path: *base_path





# =============================================================================
#  ╔═╗╦  ╔═╗╔╦╗╔═╗
#  ╠═╝║  ║ ║ ║ ╚═╗
#  ╩  ╩═╝╚═╝ ╩ ╚═╝
# =============================================================================
# -- Plot of the predator density against the prey density --------------------
phase_space:  # FIXME Migrate plot
  based_on: .time_series.phase_space

  model_name: PredatorPrey

  # Select the data
  x: predator
  y: prey

  # Set helpers accordingly
  helpers:
    set_labels:
      x: Predator Density $[1/A]$
      y: Prey Density $[1/A]$

  # How to color-code the time axis
  cmap: viridis_r

  # All below: passed on to plt.scatter
  s: 3.5


# -- Time series of the predator and prey densities ---------------------------
species_densities:  # FIXME Migrate plot
  based_on: .time_series.densities

  helpers:
    set_limits:
      x: [0, max]
    set_labels:
      y: Density $[1/A]$
    set_title:
      title: Predator and Prey Densities

  model_name: PredatorPrey

  # Which data to calculate the densities from
  to_plot:
    predator:
      mean_of: [x, y]
      preprocess:
        - create_mask: [==, 1]
      label: Predator

    prey:
      mean_of: [x, y]
      preprocess:
        - create_mask: [==, 1]
      label: Prey

# -- Time series of the predator and prey resources ---------------------------
mean_resources:  # FIXME Migrate plot
  based_on: .basic_uni.lineplots

  helpers:
    set_limits:
      x: [0, max]
      y: [0, ~]
    set_labels:
      y: Resource Density $[1/A]$
    set_title:
      title: Mean Total Resources

  model_name: PredatorPrey

  # Take average only of cells with resources >= 1
  to_plot:
    resource_predator:
      path_to_data: resource_predator
      transform_data:
        - where: [ge, 1]
        - mean: [x, y]
      label: Predator

    resource_prey:
      path_to_data: resource_prey
      transform_data:
        - where: [ge, 1]
        - mean: [x, y]
      label: Prey


# -- A grid animation that shows combined predator and prey positions ---------
combined_grid_animation_frames: &combined_grid_anim
  based_on: .ca.state.anim_frames

  model_name: PredatorPrey

  # Use the custom plotting function
  module: model_plots.PredatorPrey
  plot_func: combine_pred_and_prey

combined_grid_animation_ffmpeg:
  <<: *combined_grid_anim
  based_on: .ca.state.anim_ffmpeg
