# Base configuration for ContDisease model plots
---
.colors:
  empty: &color_empty darkkhaki
  tree: &color_tree forestgreen
  infected: &color_infected firebrick
  source: &color_source orange
  stone: &color_stone slategray

  cycler: &cycler 'cycler(
      "color",
      ["darkkhaki", "forestgreen", "firebrick", "orange", "slategray",]
  )'

# -- Any kind of phase plot ---------------------------------------------------
phase_diagram:
  based_on: .default_style_and_helpers

  creator: universe
  universes: all

  module: model_plots.ContDisease
  plot_func: phase_diagram

  cmap: viridis_r

  helpers:
    set_title:
      title: Phase Diagram


# -- Densities plot -----------------------------------------------------------
densities:
  based_on:
    - .creator.universe
    - .dag.generic.facet_grid

  select:
    data:
      path: data/ContDisease/densities
      transform:
        - .data

  x: time
  hue: kind

  style:
    axes.prop_cycle: *cycler

  helpers:
    set_limits:
      x: [min, max]
      y: [0., 1.]
    set_labels:
      x: Time [Iteration Steps]
      y: Density [1/A]
    set_title:
      title: Densities
    set_legend:
      loc: best

# TODO Facet grid version?


# --- Grid Snapshots ----------------------------------------------------------
# NOTE These can also be used as basis for grid animations.
# ... The forest ..............................................................
forest_snapshot:
  based_on: .ca.state
  model_name: ContDisease
  
  to_plot:
    kind:
      title: Forest State
      limits: [0, 4]
      cmap:
        empty: *color_empty
        tree: *color_tree
        infected: *color_infected
        source: *color_source
        stone: *color_stone

# ... The forest age ..........................................................
forest_age_snapshot:
  based_on: .ca.state
  model_name: ContDisease

  to_plot:
    age:
      title: Forest Age
      cmap: YlGn

# ... The clusters ............................................................
clusters_snapshot:  # FIXME Migrate
  based_on: .ca.state
  model_name: ContDisease

  to_plot:
    cluster_id:
      title: Clusters
      limits: [0, 20]
      cmap: tab20
      no_cbar_markings: true

  transform_data:
    cluster_id:
      - where: ['!=', 0]       # 0 is masked: not part of a cluster
      - mod: 20                # ... to match the tab20 color map
